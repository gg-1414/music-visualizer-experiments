<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<script>

</script>
<body>
  <!-- <input type="file" id="thefile" accept="audio/*"> -->
  <!-- <audio src="file:///Users/ginalee/learn-co/recognizer/audio/Illenium-Its_All_On_You.mp3" controls></audio> -->
  <!-- <script>
    const audio = document.querySelector('audio')

    var context = new AudioContext();
    var audioBuffer;
    var sourceNode;
   javascriptNode = context.createScriptProcessor(2048, 1, 1);

    setupAudioNodes();
    loadSound(audio.src);

    function setupAudioNodes() {
      // setup a javascript node
      javascriptNode = context.createScriptProcessor(2048, 1, 1);
      // connect to destination, else it isn't called
      javascriptNode.connect(context.destination);

      // setup a analyzer
      analyser = context.createAnalyser();
      analyser.smoothingTimeConstant = 0.3;
      analyser.fftSize = 1024;

      // create a buffer source node
      sourceNode = context.createBufferSource();

      // connect the source to the analyser
      sourceNode.connect(analyser);

      // we use the javascript node to draw at a specific interval.
      analyser.connect(javascriptNode);

      // and connect to destination, if you want audio
     sourceNode.connect(context.destination);
    }

    function loadSound(url) {
      var request = new XMLHttpRequest();
      request.open('GET', url, true);
      request.responseType = 'arraybuffer';

      // When loaded decode the data
      request.onload = function() {
        context.decodeAudioData(request.response, function(buffer) {
            // when the audio is decoded play the sound
          playSound(buffer);
        }, onError);
      }
      request.send();
    }

    function playSound(buffer) {
        sourceNode.buffer = buffer;
        sourceNode.start(0);
    }

    function onError(e) {
       console.log(e);
   }

   javascriptNode.onaudioprocess = function() {

    // get the average for the first channel
    var array =  new Uint8Array(analyser.frequencyBinCount);
    analyser.getByteFrequencyData(array);
    // var average = getAverageVolume(array);

    let canvas = document.createElement('canvas')
    const ctx = canvas.getContext("2d");
    const WIDTH = window.innerWidth;
    const HEIGHT = window.innerHeight;

    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, WIDTH, HEIGHT);

    // clear the current state
    ctx.clearRect(0, 0, 60, 130);

    // set the fill style
    ctx.fillStyle='rgb(180, 50, 250)'

    // create the meters
    ctx.fillRect(0,130,25,130);
    ctx.fillRect(30,130,25,130);
  }

    function getAverageVolume(array) {
        var values = 0;
        var average;

        var length = array.length;

        // get all the frequency amplitudes
        for (var i = 0; i < length; i++) {
            values += array[i];
        }

        average = values / length;
        return average;
    }


  </script> -->
  

</body>
</html>
